<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/menu_layout}">
<head>
    <title>스케줄 수정</title>
    <link th:href="@{/css/manager_list.css}" rel="stylesheet"/>
    <!-- jquery CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- fullcalendar CDN -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/main.min.css' rel='stylesheet'/>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/main.min.js'></script>
    <!-- fullcalendar 언어 CDN -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/locales-all.min.js'></script>
    <script>

        document.addEventListener('DOMContentLoaded', function () {
            var initialLocaleCode = 'ko';
            var localeSelectorEl = document.getElementById('locale-selector');
            /* initialize the external events
            -----------------------------------------------------------------*/

            var containerEl = document.getElementById('external-events-list');
            new FullCalendar.Draggable(containerEl, {
                itemSelector: '.fc-event',
                eventData: function (eventEl) {
                    return {
                        title: eventEl.innerText.trim()
                    }
                }
            });

            //// the individual way to do it
            // var containerEl = document.getElementById('external-events-list');
            // var eventEls = Array.prototype.slice.call(
            //   containerEl.querySelectorAll('.fc-event')
            // );
            // eventEls.forEach(function(eventEl) {
            //   new FullCalendar.Draggable(eventEl, {
            //     eventData: {
            //       title: eventEl.innerText.trim(),
            //     }
            //   });
            // });

            /* initialize the calendar
            -----------------------------------------------------------------*/
        var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialDate: '2022-02-07',
                initialView: 'timeGridWeek',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
                },
                editable: true,
                droppable: true, // this allows things to be dropped onto the calendar
                drop: function (arg) {
                    // is the "remove after drop" checkbox checked?
                    if (document.getElementById('drop-remove').checked) {
                        // if so, remove the element from the "Draggable Events" list
                        arg.draggedEl.parentNode.removeChild(arg.draggedEl);
                    }
                },
                events: [
                    {
                        title: '스케줄 수정 요청 기간',
                        color: 'darksalmon',
                        start: '2022-02-07',
                        end: '2022-02-13'
                    },
                    {
                        title: '김희수',
                        color: 'yellowgreen',
                        start: '2022-02-10T11:00:00',
                        end: '2022-02-10T13:00:00'
                    },
                    {
                        title: '김희수',
                        color: 'yellowgreen',
                        start: '2022-02-08T11:00:00',
                        end: '2022-02-08T13:00:00'
                    },
                    {
                        title: '김희수',
                        color: 'yellowgreen',
                        start: '2022-02-07T11:00:00',
                        end: '2022-02-07T13:00:00'
                    },
                    {
                        title: '정민환',
                        color: '#3788d8',
                        start: '2022-02-07T08:00:00',
                        end: '2022-02-07T10:00:00'
                    },
                    {
                        title: '정민환',
                        color: '#3788d8',
                        start: '2022-02-09T08:00:00',
                        end: '2022-02-09T10:00:00'
                    },
                    {
                        title: '정민환',
                        color: '#3788d8',
                        start: '2022-02-12T08:00:00',
                        end: '2022-02-12T10:00:00'
                    },
                    {
                        title: '박태영',
                        color: 'coral',
                        start: '2022-02-07T16:00:00',
                        end: '2022-02-07T18:00:00'
                    },
                    {
                        title: '박태영',
                        color: 'coral',
                        start: '2022-02-11T16:00:00',
                        end: '2022-02-11T18:00:00'
                    },
                    {
                        title: '이혜원',
                        color: 'darkorchid',
                        start: '2022-02-12T15:00:00',
                        end: '2022-02-12T17:30:00'
                    },
                    {
                        title: '이혜원',
                        color: 'darkorchid',
                        start: '2022-02-07T15:00:00',
                        end: '2022-02-07T17:30:00'
                    },
                    {
                        title: '박태영',
                        color: 'coral',
                        start: '2022-02-09T16:00:00',
                        end: '2022-02-09T18:30:00'
                    },
                    {
                        title: '이혜원',
                        color: 'darkorchid',
                        start: '2022-02-09T17:00:00',
                        end: '2022-02-09T19:30:00'
                    },
                    {
                        title: '이혜원',
                        start: '2020-09-16T16:00:00'
                    },
                    {
                        title: 'Click for Google',
                        url: 'http://google.com/',
                        start: '2020-09-28'
                    }
                ]
            });
            calendar.render();

        });

    </script>
    <style>
        body {
            font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
            font-size: 14px;
        }

        table {
            text-align: left;
        }

        .access_user {
            width: 300px;
            height: 100px;
            float: right;
            margin-right: 100px;
            padding-top: 50px;
        }

        #external-events {
            position: absolute;
            /*left: 100 px;*/
            /*top: 100px;*/
            width: 150px;
            overflow: hidden;
            padding: 0 10px;
            margin-top: 80px;
            border: 1px solid #ccc;
            background: #eee;
            text-align: left;
        }

        #external-events h4 {
            font-size: 16px;
            margin-top: 0;
            padding-top: 1em;
        }

        #external-events .fc-event {
            margin: 3px 0;
            cursor: move;
        }

        #external-events p {
            margin: 1.5em 0;
            font-size: 11px;
            color: #666;
        }

        #external-events p input {
            margin: 0;
            vertical-align: middle;
        }

        #calendar-wrap {
            margin-left: 200px;
        }

        #calendar {
            max-width: 1100px;
            margin: 40px auto;
            padding: 0 10px;
        }
    </style>

</head>

<th:block layout:fragment="ground-wrap">
    <div class="ground">
        <div class="main">
            <div class="title1">
                <h1>스케줄 수정</h1>
            </div>
            <div id='wrap'>
                <div id='external-events'>
                    <h4>Draggable Events</h4>
                    <div id='external-events-list'>
                        <div class='fc-event fc-h-event fc-daygrid-event fc-daygrid-block-event'>
                            <div class='fc-event-main'>My Event 1</div>
                        </div>
                        <div class='fc-event fc-h-event fc-daygrid-event fc-daygrid-block-event'>
                            <div class='fc-event-main'>My Event 2</div>
                        </div>
                        <div class='fc-event fc-h-event fc-daygrid-event fc-daygrid-block-event'>
                            <div class='fc-event-main'>My Event 3</div>
                        </div>
                        <div class='fc-event fc-h-event fc-daygrid-event fc-daygrid-block-event'>
                            <div class='fc-event-main'>My Event 4</div>
                        </div>
                        <div class='fc-event fc-h-event fc-daygrid-event fc-daygrid-block-event'>
                            <div class='fc-event-main'>My Event 5</div>
                        </div>

                    </div>
                    <p>
                        <input type='checkbox' id='drop-remove'/>
                        <label for='drop-remove'>remove after drop</label>
                    </p>
                </div>
                <div id='calendar-wrap'>
                    <div id='calendar'></div>
                </div>
            </div>
        </div>
    </div>

    <script src="fullcalendar/lib/locales-all.js"></script>

    <script>
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: ["dayGrid"]
            , locale: "ko"
        });

    </script>

    <script>
        // 기본 위치(top)값
        var floatPosition = parseInt($("#external-events").css('top'))

        // scroll 인식
        $(window).scroll(function () {
            // 현재 스크롤 위치
            var currentTop = $(window).scrollTop();
            var bannerTop = currentTop + floatPosition + "px";

            //이동 애니메이션
            $("#external-events").stop().animate({
                "top": bannerTop
            }, 500);
        }).scroll();
    </script>
</th:block>
</html>